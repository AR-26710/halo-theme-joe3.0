const journalContext={initEffect(){$(".joe_loading").remove(),$(".joe_journals__list").removeClass("hidden"),ThemeConfig_enable_journal_effect&&new WOW({boxClass:"wow",animateClass:ThemeConfig_journal_list_effect_class||"fadeIn",offset:0,mobile:!0,live:!0}).init()},formatTime(){$(".joe_journal-posttime").each(function(){var e=$(this);e.html(Utils.timeAgo(e.text()))})},initLike(){var e;ThemeConfig_enable_like_journal&&(e=$(".joe_journal__item")).length&&e.each(function(e,n){var o=$(this);const a=o.attr("data-cid"),l=+(o.attr("data-clikes")||0);let i=localStorage.getItem(encryption("agree-journal"))?JSON.parse(decrypt(localStorage.getItem(encryption("agree-journal")))):[],r=i.includes(a);const s=o.find(".journal-like"),c=o.find(".journal-unlike"),d=o.find(".journal-likes-num");r?(s.hide(),c.show()):(s.show(),c.hide()),d.html(l),s.on("click",function(e){e.stopPropagation();let n;n=!0,i=localStorage.getItem(encryption("agree-journal"))?JSON.parse(decrypt(localStorage.getItem(encryption("agree-journal")))):[],r=i.includes(a),Utils.request({url:"/api/content/journals/"+a+"/likes",method:"POST",data:{type:r?"disagree":"agree"}}).then(e=>{let n=l;r?(n--,o=i.findIndex(e=>e===a),i.splice(o,1),s.show(),c.hide()):(n++,i.push(a),s.hide(),c.show());var o=encryption("agree-journal"),t=encryption(JSON.stringify(i));localStorage.setItem(o,t),d.html(n)}).catch(e=>{})})})},initComment(){!ThemeConfig_enable_clean_mode&&ThemeConfig_enable_comment_journal&&$(".journal_comment_expander,.journal-comment").on("click",function(e){e.stopPropagation();var e=$(this).parents(".footer-wrap"),n=e.find("halo-comment")[0]._wrapper.$refs.inner;e.hasClass("open")||n.loadComments(),e.toggleClass("open"),e.find(".journal_comment_expander_txt").html((e.hasClass("open")?"收起":"查看")+"评论")})},initExpander(){$(".journal_content_expander i").on("click",function(e){e.stopPropagation(),$(this).parents(".joe_journal_body").toggleClass("open")})},foldBlock(){$(".joe_journal_body .content-wrp").each(function(){var e=$(this);e[0].getBoundingClientRect().height>=ThemeConfig_journal_block_height&&e.siblings(".journal_content_expander").show()})}};!function(){const n=["foldBlock"];document.addEventListener("DOMContentLoaded",function(){Object.keys(journalContext).forEach(e=>!n.includes(e)&&journalContext[e]())}),window.addEventListener("load",function(){journalContext.foldBlock()})}();