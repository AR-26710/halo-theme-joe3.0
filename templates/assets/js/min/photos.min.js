class Sortable{constructor({parent:t,links:e=document.querySelectorAll("[data-sjslink]"),active:i="active",margin:s=20,responsive:r={980:{columns:3},480:{columns:2},0:{columns:1}},fadeDuration:n={in:300,out:0}}={}){this.parent=t,this.links=Array.from(e),this.active=i,this.margin=s,this.responsive=r,this.fadeDuration=n,this.elements=Array.from(this.parent.children),this.activeElements=this.elements,this.columns=1,this.dataLink="all",this.winWidth=window.innerWidth,this.init()}orderelements(){let{parent:t,activeElements:e,columns:n,blocWidth:a,margin:l}=this;var i=e.reduce((t,e,i)=>{var s=this._sumArrHeight(t,n),r=i%n*(a+l),s=0<=i-n?s[i%n]+l*Math.floor(i/n):0;return e.style.transform=`translate3d(${r}px, ${s}px, 0)`,t.push(e.offsetHeight),t},[]),i=this._sumArrHeight(i,n),i=Math.max(...i)+l*(Math.floor(e.length/n)-1);t.style.height=i+"px"}handleFilterClick(t,e){t.preventDefault();let{links:i,active:s}=this;e.dataset.sjslink!==this.dataLink&&(this.dataLink=e.dataset.sjslink,i.forEach(t=>{t.isEqualNode(e)?t.classList.add(s):t.classList.remove(s)}),this._filterElements(()=>{this.orderelements()}))}resize(){window.addEventListener("resize",()=>{clearTimeout(window.sortableResize),window.sortableResize=setTimeout(()=>{this.winWidth=window.innerWidth,this._setBlocWidth(()=>{this.orderelements()})},500)})}init(){let{parent:t,links:e,active:i}=this;e.forEach((e,t)=>{0===t&&(e.classList.add(i),this.dataLink=e.dataset.sjslink),e.addEventListener("click",t=>{this.handleFilterClick(t,e)})}),this._setBlocWidth(),window.addEventListener("load",()=>{this._filterElements(()=>{this.orderelements()}),t.style.opacity=1}),this.resize();const s=new IntersectionObserver(t=>{t.forEach(t=>{var e;t.isIntersecting&&(e=(t=t.target).getAttribute("data-src"),t.setAttribute("src",e),s.unobserve(t))})},{threshold:.5});document.querySelectorAll("img.card__picture").forEach(t=>{s.observe(t)})}_setBlocWidth(t){var{parent:e,elements:i,margin:s,responsive:r}=this,r=this.columns=this._columnsCount(r).columns;let n=this.blocWidth=(e.clientWidth-s*(r-1))/r;i.forEach(t=>{t.style.width=n+"px"}),t&&t()}_filterElements(t){let{elements:e,dataLink:i,fadeDuration:s}=this;this.activeElements=e.filter(t=>"all"!==i&&t.dataset.sjsel!==i?(this._fadeOut(t,s.out),!1):(this._fadeIn(t,s.in),this._lazyLoadImages(t),!0)),t&&t()}_lazyLoadImages(t){t=t.querySelectorAll('img[loading="lazy"]');const e=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&((t=t.target).src=t.dataset.src,t.removeAttribute("loading"),e.unobserve(t))})});t.forEach(t=>{e.observe(t)})}_sumArrHeight(t,s){return t.reduce((t,e,i)=>{i%=s;return t[i]||(t[i]=0),t[i]=t[i]+e,t},[])}_columnsCount(t){let i=this["winWidth"];return Object.entries(t).reduce((t,e)=>i>e[0]&&e[0]>=Math.max(t.width)?{width:e[0],columns:e[1].columns}:t,{width:0,columns:4})}_fadeIn(e,t=300,i){let s=parseFloat(window.getComputedStyle(e,null).getPropertyValue("opacity")),r=16/t;e.style.display="block",requestAnimationFrame(function t(){(s+=r)<=1?(e.style.opacity=s,requestAnimationFrame(t)):(e.style.opacity=1,i&&i())})}_fadeOut(e,t=300,i){let s=parseFloat(window.getComputedStyle(e,null).getPropertyValue("opacity")),r=t?16/t:1;requestAnimationFrame(function t(){0<=(s-=r)?(e.style.opacity=s,requestAnimationFrame(t)):(e.style.opacity=0,e.style.display="none",i&&i())})}}HTMLElement.prototype.sortablejs=HTMLElement.prototype.sortablejs||function(t){return new Sortable({parent:this,...t})};